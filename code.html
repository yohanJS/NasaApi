<!doctype html>
<html lang="en" class="h-100">

<head>
    <title>NasaApp: A Coding Project by Yohan Valdes</title>
    <link rel="icon" href="./img/nasa-logo.png">
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    
        <!--External StyleSheet-->
    <link href="./css/site.css" rel="stylesheet">

    <!--Font Awesome Icons-->
    <script src="https://kit.fontawesome.com/5db21ba9c6.js" crossorigin="anonymous"></script>
    <link rel="icon" href="./img/YG.svg" type="image/png">

    <!--Link Prism-->
    <link href="./css/prism.css" rel="stylesheet">
</head>

<body class="d-flex flex-column h-100">

    <!--Nav Section-->
    <nav class="navbar navbar-expand-md bg-light text-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="https://www.yohancraft.com/" target="_blank"><img src="./img/logo.png" alt="Logo" height="100"></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse"
                aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarCollapse">
                <ul class="navbar-nav me-auto mb-2 mb-md-0">
                    <li class="nav-item">
                        <a class="nav-link" href="./index.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="./app.html">NasaApp</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="./code.html">The Code</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" target="_blank" href="https://github.com/yohanJS/NasaApi">Git Repo</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" target="_blank" href="https://yohanvaldes.me/">About</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!--Main Section-->
    <main class="flex-shrink-0 p-5 bg-secondary text-white">
        <div class="container py-4 mt-5">
            <h2 class="border-1 border-bottom text-dark mt-5">The Code for NasaApp</h2>
            <div class="row row-cols-1 row-cols-md-2">
                <div class="col-12 col-lg-7">
                    <pre class="line-numbers"><code class="language-javascript">
"use strict"

let $ = (id)=> {
  return document.getElementById(id);
}

let content = $("content");
let images = $("my-images");

//KEY TO ACCESS NASA API
const MyKEY = "*******************************";

let fetchBySol = async () => {
  //the user can retrieve resources by SOL number
  let sol = $("sol").value;

  //prevents the app from crashing if the user enters 0
  if($("sol").value == 0) {
    alert("Input must be greater than 0.\nTry Again!");
  } else {

    let res = await fetch(`https://api.nasa.gov/mars-photos/api/v1/rovers/curiosity/photos?sol=${sol}&api_key=${MyKEY}`)

    try{

      let data = await res.json();
      
          content.innerHTML += `<strong>On Sol</strong> ${sol}, there are a total of ${data.photos.length} photos.<br>`;
          content.innerHTML += `<strong>Camera Used:</strong> ${data.photos[0].camera.full_name}.<br>`;
          content.innerHTML += `<strong>Date on earth:</strong> ${data.photos[0].earth_date}.<br>`;
          content.innerHTML += `<strong>Landing Date</strong> ${data.photos[0].rover.landing_date}.<br>`;
          content.innerHTML += `<strong>Rover Name:</strong> ${data.photos[0].rover.name}.<br>`;
          
          //using the map function we iterate over the photos array
          //and insert them inside an image element using the source
          //attribute
          data.photos.map((photo) => {
            images.innerHTML += `<img src="${photo.img_src}" id="my-image"><br>`;
          });
    } catch(err){
      content.innerHTML += `Try another Sol.`;
    }
  }
}


window.onload = function() {
  $("find").onclick = function() {
    content.innerHTML = "";
    images.innerHTML = "";
    fetchBySol();
  }
}                        
                    </code></pre>
                </div>
                <div class="col col-lg-5">
                    <div>
                        <h5 class="text-dark">The Code is Structured in Two Functions</h5>
                        <p>
                            The first function simply uses a return statement to grab the ID 
                            of a specific element, and return its value.
                        </p>
                        <p>
                            Following, we are grabbing the content, and the my-images container
                            where we will insert the data we are trying to retrieve.
                        </p>
                        <p>
                            The <strong>MyKEY</strong> variable simply holds my personal key to access the Nasa Api.
                        </p>
                        <p>
                            Next, we declared a function called <strong>fetchBySol</strong> that uses the <strong>async</strong>
                            keyword. This is a syntactic feature that allows for asynchronous, non-blocking pattern.
                            For more details visit the link.
                            <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" target="_blank">async function</a>.
                        </p>
                        <p>
                            Inside the <strong>fetchBySol</strong> function a few things are happening.
                            First we get the user's input value. We make sure that if the user enters 0 the
                            app does not crash. If the entry is valid we fetch the data using the <strong>await</strong>
                            keyword. For more details vist <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" target="_blank">async function</a>
                            . Inside the <strong>fetch</strong> function we used a <strong>try/catch</strong> block statement.
                            If the response is valid, we obtain an object with the data. Then we access the object and 
                            insert the data in the <strong>content</strong> and <strong>my-images</strong>
                            elements. If an error is encountered, we provided some feedback to the user.
                        </p>
                        <p>
                            Finally, once the window loads we add an event listener to the find button, and we call the
                            <strong>fetchBySol</strong> function.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!--Footer Section-->
    <footer class="footer mt-auto py-3 text-dark">
        <div class="container-fluid">
            <div class="row row-cols-1 row-cols-md-3 gy-3">
                <div class="col order-last order-lg-first">
                    <div class="text-center"><span class="text-muted">&copy;2022</span> Yohan Valdes  | yohancraft@icloud.com</div>
                </div>
                <div class="col order-last d-flex align-items-center justify-content-center">
                    <a href="https://yohanvaldes.me/" target="_blank">
                        <img src="./img/logo.png" alt="Logo" height="100">   
                    </a>
                </div>
                <div class="col d-flex  align-items-center justify-content-center">
                    <div class="row">
                        <div class="col"><a href="https://www.linkedin.com/in/yohanjs/" target="_blank"><i class="fab fa-linkedin fa-2x txt-color"></i></a></div>
                        <div class="col"><a href="https://github.com/yohanJS" target="_blank"><i class="fab fa-github fa-2x txt-color"></i></a></div>
                        <div class="col"><a href="#"><i class="fab fa-youtube fa-2x txt-color"></i></a></div>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
        integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous">
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
        integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous">
    </script>
    
    <!--linked prism js-->
    <script src="./js/prism.js"></script>
</body>

</html>